<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CarGame.MainPage"
             BackgroundColor="Black">

    <Grid>
        <!-- Game Canvas -->
        <GraphicsView x:Name="GameView" />

        <!-- HUD -->
        <Grid x:Name="HudGrid" Padding="16" RowDefinitions="Auto,*" InputTransparent="True">
            <HorizontalStackLayout Spacing="18">
                <Label x:Name="ScoreLabel"
                       Text="Score: 0"
                       TextColor="White"
                       FontSize="18" />

                <Label x:Name="CoinsLabel"
                       Text="Coins: 0"
                       TextColor="White"
                       FontSize="18" />
                <Label x:Name="HighScoreLabel"
                       Text="High: 0"
                       TextColor="White"
                       FontSize="18" />

                <Label x:Name="LivesLabel"
                       Text="❤❤❤"
                       TextColor="White"
                       FontSize="18" />
            </HorizontalStackLayout>

            <Label x:Name="HintLabel"
                   Grid.Row="1"
                   Text="Swipe left/right to change lanes"
                   TextColor="White"
                   Opacity="0.8"
                   VerticalOptions="End"
                   HorizontalOptions="Center"
                   Margin="0,0,0,30"/>
        </Grid>

        <!-- Pause button -->
        <Button x:Name="PauseButton"
                Text="Pause"
                WidthRequest="90"
                HeightRequest="42"
                HorizontalOptions="End"
                VerticalOptions="Start"
                Margin="0,12,12,0"
                Clicked="PauseButton_Clicked" />

        <!-- MAIN MENU OVERLAY -->
        <Grid x:Name="MainMenuOverlay"
              BackgroundColor="#B0000000"
              IsVisible="True">

            <Frame Padding="26"
                   CornerRadius="22"
                   HasShadow="True"
                   BackgroundColor="#202020"
                   BorderColor="#3A3A3A"
                   HorizontalOptions="Center"
                   VerticalOptions="Center">
                <VerticalStackLayout Spacing="14" HorizontalOptions="Center">
                    <Label Text="Traffic Escape"
                           FontSize="34"
                           TextColor="White"
                           HorizontalTextAlignment="Center" />

                    <Label Text="Avoid cars • Collect coins"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center"
                           Margin="0,0,0,4" />

                    <Label x:Name="TotalCoinsMenuLabel"
                           Text="Total Coins: 0"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center"
                           Margin="0,0,0,10" />

                    <Button Text="Play"
                            WidthRequest="220"
                            Clicked="Play_Clicked" />

                    <Button Text="Settings"
                            WidthRequest="220"
                            Clicked="Settings_Clicked" />

                    <Button Text="?"
                            WidthRequest="220"
                            Clicked="HowTo_Clicked" />
                </VerticalStackLayout>
            </Frame>
        </Grid>

        <!-- SETTINGS OVERLAY -->
        <Grid x:Name="SettingsOverlay"
              BackgroundColor="#B0000000"
              IsVisible="False">
            <Frame Padding="22"
                   CornerRadius="22"
                   HasShadow="True"
                   BackgroundColor="#202020"
                   BorderColor="#3A3A3A"
                   HorizontalOptions="Center"
                   VerticalOptions="Center">

                <VerticalStackLayout Spacing="14">
                    <Label Text="Choose your car"
                           FontSize="22"
                           TextColor="White"
                           HorizontalTextAlignment="Center" />

                    <Label x:Name="TotalCoinsSettingsLabel"
                           Text="Total Coins: 0"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center" />

                    <Label x:Name="SelectedCarLabel"
                           Text="Selected: Yellow"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center" />

                    <HorizontalStackLayout Spacing="16" HorizontalOptions="Center">
                        <VerticalStackLayout Spacing="6" HorizontalOptions="Center">
                            <ImageButton x:Name="CarYellowButton" Source="car_yellow.png" WidthRequest="90" HeightRequest="120" Clicked="CarYellow_Clicked" BackgroundColor="Transparent" />
                            <Label x:Name="CarYellowUnlockLabel" Text="Default" FontSize="12" TextColor="#CFCFCF" HorizontalTextAlignment="Center" />
                        </VerticalStackLayout>

                        <VerticalStackLayout Spacing="6" HorizontalOptions="Center">
                            <ImageButton x:Name="CarRedButton" Source="car_purple.png" WidthRequest="90" HeightRequest="120" Clicked="CarRed_Clicked" BackgroundColor="Transparent" />
                            <Label x:Name="CarRedUnlockLabel" Text="25" FontSize="12" TextColor="#CFCFCF" HorizontalTextAlignment="Center" />
                        </VerticalStackLayout>

                        <VerticalStackLayout Spacing="6" HorizontalOptions="Center">
                            <ImageButton x:Name="CarBlueButton" Source="car_blue.png" WidthRequest="90" HeightRequest="120" Clicked="CarBlue_Clicked" BackgroundColor="Transparent" />
                            <Label x:Name="CarBlueUnlockLabel" Text="50" FontSize="12" TextColor="#CFCFCF" HorizontalTextAlignment="Center" />
                        </VerticalStackLayout>

                        <VerticalStackLayout Spacing="6" HorizontalOptions="Center">
                            <ImageButton x:Name="CarGreenButton" Source="car_green.png" WidthRequest="90" HeightRequest="120" Clicked="CarGreen_Clicked" BackgroundColor="Transparent" />
                            <Label x:Name="CarGreenUnlockLabel" Text="75" FontSize="12" TextColor="#CFCFCF" HorizontalTextAlignment="Center" />
                        </VerticalStackLayout>
                    </HorizontalStackLayout>

                    <Button Text="Back"
                            Clicked="SettingsBack_Clicked" />
                </VerticalStackLayout>
            </Frame>
        </Grid>

        <!-- HOW TO PLAY OVERLAY -->
        <Grid x:Name="HowToOverlay"
              BackgroundColor="#B0000000"
              IsVisible="False">
            <Frame Padding="12"
                   CornerRadius="22"
                   HasShadow="True"
                   BackgroundColor="#202020"
                   BorderColor="#3A3A3A"
                   HorizontalOptions="Center"
                   VerticalOptions="Center">
                <Grid RowDefinitions="*,Auto">
                    <ScrollView>
                        <Image Source="howto.png" Aspect="AspectFit" />
                    </ScrollView>

                    <Button Grid.Row="1" Text="Close" Clicked="HowToClose_Clicked" />
                </Grid>
            </Frame>
        </Grid>
    </Grid>

</ContentPage>
