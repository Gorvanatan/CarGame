<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CarGame.MainPage"
             BackgroundColor="Black"
             Shell.NavBarIsVisible="False">

    <Grid>
        <!-- Game Canvas -->
        <GraphicsView x:Name="GameView" />

        <!-- HUD -->
        <Grid x:Name="HudGrid" Padding="16" RowDefinitions="Auto,*" InputTransparent="True">
            <HorizontalStackLayout Spacing="18">
                <Label x:Name="ScoreLabel"
                       Text="Score: 0"
                       TextColor="White"
                       FontSize="18" />

                <Label x:Name="CoinsLabel"
                       Text="Coins: 0"
                       TextColor="White"
                       FontSize="18" />
                <Label x:Name="HighScoreLabel"
                       Text="High: 0"
                       TextColor="White"
                       FontSize="18" />

                <Label x:Name="LivesLabel"
                       Text="❤❤❤"
                       TextColor="White"
                       FontSize="18" />

                <Label x:Name="InvincibleLabel"
                       Text="INV"
                       TextColor="Yellow"
                       FontSize="18"
                       IsVisible="False" />
            </HorizontalStackLayout>

            <Label x:Name="HintLabel"
                   Grid.Row="1"
                   Text="Swipe left/right to change lanes"
                   TextColor="White"
                   Opacity="0.8"
                   VerticalOptions="End"
                   HorizontalOptions="Center"
                   Margin="0,0,0,30"/>
        </Grid>

        <!-- Pause button -->
        <Button x:Name="PauseButton"
                Text="Pause"
                WidthRequest="90"
                HeightRequest="42"
                HorizontalOptions="End"
                VerticalOptions="Start"
                Margin="0,12,12,0"
                Clicked="PauseButton_Clicked" />

        <!-- PAUSE MENU OVERLAY (during gameplay) -->
        <Grid x:Name="PauseOverlay"
              BackgroundColor="#B0000000"
              IsVisible="False">

            <Frame Padding="22"
                   CornerRadius="22"
                   HasShadow="True"
                   BackgroundColor="#202020"
                   BorderColor="#3A3A3A"
                   HorizontalOptions="Center"
                   VerticalOptions="Center">

                <VerticalStackLayout Spacing="14" WidthRequest="300" HorizontalOptions="Center">
                    <Label Text="Paused"
                           FontSize="26"
                           TextColor="White"
                           HorizontalTextAlignment="Center" />

                    <Button Text="Resume"
                            WidthRequest="220"
                            Clicked="PauseResume_Clicked" />

                    <Button Text="Restart Run"
                            WidthRequest="220"
                            Clicked="PauseRestart_Clicked" />

                    <Button Text="Settings"
                            WidthRequest="220"
                            Clicked="PauseSettings_Clicked" />

                    <Button Text="Main Menu"
                            WidthRequest="220"
                            Clicked="PauseMainMenu_Clicked" />
                </VerticalStackLayout>
            </Frame>
        </Grid>


<!-- GAME OVER OVERLAY -->
<Grid x:Name="GameOverOverlay"
      BackgroundColor="#B0000000"
      IsVisible="False">

    <Frame Padding="22"
           CornerRadius="22"
           HasShadow="True"
           BackgroundColor="#202020"
           BorderColor="#3A3A3A"
           HorizontalOptions="Center"
           VerticalOptions="Center">

        <VerticalStackLayout Spacing="12" WidthRequest="320" HorizontalOptions="Center">
            <Label Text="Game Over"
                   FontSize="28"
                   TextColor="White"
                   HorizontalTextAlignment="Center" />

            <Label x:Name="FinalScoreLabel"
                   Text="Score: 0"
                   FontSize="16"
                   TextColor="#CFCFCF"
                   HorizontalTextAlignment="Center" />

            <Label x:Name="FinalHighScoreLabel"
                   Text="High Score: 0"
                   FontSize="16"
                   TextColor="#CFCFCF"
                   HorizontalTextAlignment="Center" />

            <Label x:Name="FinalCoinsRunLabel"
                   Text="Coins this run: 0"
                   FontSize="14"
                   TextColor="#AFAFAF"
                   HorizontalTextAlignment="Center" />

            <Label x:Name="FinalCoinsHeldLabel"
                   Text="Coins held: 0"
                   FontSize="14"
                   TextColor="#AFAFAF"
                   HorizontalTextAlignment="Center"
                   Margin="0,-6,0,0" />

            <Label x:Name="NewHighScoreBadgeLabel"
                   Text="NEW HIGH SCORE!"
                   FontSize="14"
                   TextColor="Gold"
                   HorizontalTextAlignment="Center"
                   IsVisible="False"
                   Margin="0,6,0,0" />

            <Button Text="Restart Run"
                    WidthRequest="220"
                    Clicked="GameOverRestart_Clicked" />

            <Button Text="Main Menu"
                    WidthRequest="220"
                    Clicked="GameOverMenu_Clicked" />
        </VerticalStackLayout>
    </Frame>
</Grid>
        <!-- MAIN MENU OVERLAY -->
        <Grid x:Name="MainMenuOverlay"
              BackgroundColor="#B0000000"
              IsVisible="True">

            <Frame Padding="26"
                   CornerRadius="22"
                   HasShadow="True"
                   BackgroundColor="#202020"
                   BorderColor="#3A3A3A"
                   HorizontalOptions="Center"
                   VerticalOptions="Center">
                <VerticalStackLayout Spacing="14" HorizontalOptions="Center">
                    <Label Text="Traffic Escape"
                           FontSize="34"
                           TextColor="White"
                           HorizontalTextAlignment="Center" />

                    <Label Text="Avoid cars • Collect coins"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center"
                           Margin="0,0,0,4" />

                    <Label x:Name="TotalCoinsMenuLabel"
                           Text="Coins Held: 0"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center"
                           Margin="0,0,0,10" />

                    <Button Text="Play"
                            WidthRequest="220"
                            Clicked="Play_Clicked" />

                    <Button Text="Shop"
                            WidthRequest="220"
                            Clicked="Shop_Clicked" />

                    <Button Text="Settings"
                            WidthRequest="220"
                            Clicked="Settings_Clicked" />

                    <Button Text="?"
                            WidthRequest="220"
                            Clicked="HowTo_Clicked" />
                </VerticalStackLayout>
            </Frame>
        </Grid>

        <!-- SHOP OVERLAY -->
        <Grid x:Name="ShopOverlay"
              BackgroundColor="#B0000000"
              IsVisible="False">
            <Frame Padding="22"
                   CornerRadius="22"
                   HasShadow="True"
                   BackgroundColor="#202020"
                   BorderColor="#3A3A3A"
                   HorizontalOptions="Center"
                   VerticalOptions="Center">

                <VerticalStackLayout Spacing="14">
                    <Label Text="Shop"
                           FontSize="22"
                           TextColor="White"
                           HorizontalTextAlignment="Center" />

                    <Label x:Name="TotalCoinsShopLabel"
                           Text="Coins Held: 0"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center" />

                    <Label x:Name="SelectedCarLabel"
                           Text="Selected: Yellow"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center" />

                    <HorizontalStackLayout Spacing="16" HorizontalOptions="Center">

    <!-- Yellow (default) -->
    <Frame x:Name="CarYellowFrame"
           Padding="6"
           CornerRadius="16"
           HasShadow="False"
           BackgroundColor="#141414"
           BorderColor="#4A4A4A">
        <VerticalStackLayout Spacing="6" HorizontalOptions="Center">
            <ImageButton x:Name="CarYellowButton"
                         Source="car_yellow.png"
                         WidthRequest="90"
                         HeightRequest="120"
                         Clicked="CarYellow_Clicked"
                         BackgroundColor="Transparent" />
            <Label x:Name="CarYellowUnlockLabel"
                   Text="Default"
                   FontSize="12"
                   TextColor="#CFCFCF"
                   HorizontalTextAlignment="Center" />
        </VerticalStackLayout>
    </Frame>

    <!-- Purple (25) -->
    <Frame x:Name="CarPurpleFrame"
           Padding="6"
           CornerRadius="16"
           HasShadow="False"
           BackgroundColor="#141414"
           BorderColor="#4A4A4A">
        <VerticalStackLayout Spacing="6" HorizontalOptions="Center">
            <ImageButton x:Name="CarRedButton"
                         Source="car_purple.png"
                         WidthRequest="90"
                         HeightRequest="120"
                         Clicked="CarRed_Clicked"
                         BackgroundColor="Transparent" />
            <Label x:Name="CarRedUnlockLabel"
                   Text="25 coins"
                   FontSize="12"
                   TextColor="#CFCFCF"
                   HorizontalTextAlignment="Center" />
        </VerticalStackLayout>
    </Frame>

    <!-- Blue (50) -->
    <Frame x:Name="CarBlueFrame"
           Padding="6"
           CornerRadius="16"
           HasShadow="False"
           BackgroundColor="#141414"
           BorderColor="#4A4A4A">
        <VerticalStackLayout Spacing="6" HorizontalOptions="Center">
            <ImageButton x:Name="CarBlueButton"
                         Source="car_blue.png"
                         WidthRequest="90"
                         HeightRequest="120"
                         Clicked="CarBlue_Clicked"
                         BackgroundColor="Transparent" />
            <Label x:Name="CarBlueUnlockLabel"
                   Text="50 coins"
                   FontSize="12"
                   TextColor="#CFCFCF"
                   HorizontalTextAlignment="Center" />
        </VerticalStackLayout>
    </Frame>

    <!-- Green (75) -->
    <Frame x:Name="CarGreenFrame"
           Padding="6"
           CornerRadius="16"
           HasShadow="False"
           BackgroundColor="#141414"
           BorderColor="#4A4A4A">
        <VerticalStackLayout Spacing="6" HorizontalOptions="Center">
            <ImageButton x:Name="CarGreenButton"
                         Source="car_green.png"
                         WidthRequest="90"
                         HeightRequest="120"
                         Clicked="CarGreen_Clicked"
                         BackgroundColor="Transparent" />
            <Label x:Name="CarGreenUnlockLabel"
                   Text="75 coins"
                   FontSize="12"
                   TextColor="#CFCFCF"
                   HorizontalTextAlignment="Center" />
        </VerticalStackLayout>
    </Frame>

</HorizontalStackLayout>

                    <BoxView HeightRequest="1" Opacity="0.25" />

                    <Label Text="Upgrades"
                           FontSize="18"
                           TextColor="White"
                           HorizontalTextAlignment="Center" />

                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto" RowSpacing="10" ColumnSpacing="12">
                        <Label x:Name="HealthUpgradeLabel"
                               Text="Max Health: 3/6"
                               TextColor="#CFCFCF"
                               FontSize="14" />
                        <Button x:Name="HealthUpgradeButton"
                                Grid.Column="1"
                                Text="Buy (50)"
                                Clicked="HealthUpgrade_Clicked" />

                        <Label x:Name="InvUpgradeLabel"
                               Grid.Row="1"
                               Text="Invincibility: 10s"
                               TextColor="#CFCFCF"
                               FontSize="14" />
                        <Button x:Name="InvUpgradeButton"
                                Grid.Row="1"
                                Grid.Column="1"
                                Text="Buy (50)"
                                Clicked="InvUpgrade_Clicked" />
                    </Grid>

                    <Button Text="Back"
                            Clicked="ShopBack_Clicked" />
                </VerticalStackLayout>
            </Frame>
        </Grid>

        <!-- SETTINGS OVERLAY -->
        <Grid x:Name="SettingsOverlay"
              BackgroundColor="#B0000000"
              IsVisible="False">
            <Frame Padding="22"
                   CornerRadius="22"
                   HasShadow="True"
                   BackgroundColor="#202020"
                   BorderColor="#3A3A3A"
                   HorizontalOptions="Center"
                   VerticalOptions="Center">

                <VerticalStackLayout Spacing="14" WidthRequest="320">
                    <Label Text="Settings"
                           FontSize="22"
                           TextColor="White"
                           HorizontalTextAlignment="Center" />

                    <Label x:Name="CoinsHeldSettingsLabel"
                           Text="Coins Held: 0"
                           FontSize="14"
                           TextColor="#CFCFCF"
                           HorizontalTextAlignment="Center" />

                    <Label x:Name="CoinsEarnedSettingsLabel"
                           Text="Total Coins Earned: 0"
                           FontSize="12"
                           TextColor="#AFAFAF"
                           HorizontalTextAlignment="Center"
                           Margin="0,-8,0,0" />

                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto" RowSpacing="6">
                        <Label Text="Volume"
                               TextColor="#CFCFCF"
                               FontSize="14" />

                        <Label x:Name="VolumeValueLabel"
                               Grid.Column="1"
                               Text="50%"
                               TextColor="#CFCFCF"
                               FontSize="14"
                               HorizontalTextAlignment="End" />

                        <Slider x:Name="VolumeSlider"
                                Grid.Row="1"
                                Grid.ColumnSpan="2"
                                Minimum="0"
                                Maximum="1"
                                Value="0.5"
                                ValueChanged="VolumeSlider_ValueChanged" />
                    </Grid>

                    <Grid ColumnDefinitions="*,Auto" VerticalOptions="Center">
                        <Label Text="Sound Effects (SFX)"
                               TextColor="#CFCFCF"
                               FontSize="14" />

                        <Switch x:Name="SfxSwitch"
                                Grid.Column="1"
                                IsToggled="True"
                                Toggled="SfxSwitch_Toggled" />
                    </Grid>

                    <Button x:Name="EraseDataButton"
                            Text="Erase User Data"
                            Clicked="EraseData_Clicked" />

                    <Label x:Name="EraseDataHintLabel"
                           Text="Resets High Score, coins, owned cars, selected car, and upgrades."
                           FontSize="12"
                           TextColor="#AFAFAF"
                           HorizontalTextAlignment="Center" />

                    <Button Text="Back"
                            Clicked="SettingsBack_Clicked" />
                </VerticalStackLayout>
            </Frame>
        </Grid>

        <!-- HOW TO PLAY OVERLAY -->
        <Grid x:Name="HowToOverlay"
              BackgroundColor="#B0000000"
              IsVisible="False">
            <Frame Padding="12"
                   CornerRadius="22"
                   HasShadow="True"
                   BackgroundColor="#202020"
                   BorderColor="#3A3A3A"
                   HorizontalOptions="Center"
                   VerticalOptions="Center">
                <Grid RowDefinitions="*,Auto">
                    <ScrollView>
                        <Image Source="howto.png" Aspect="AspectFit" />
                    </ScrollView>

                    <Button Grid.Row="1" Text="Close" Clicked="HowToClose_Clicked" />
                </Grid>
            </Frame>
        </Grid>
    </Grid>

</ContentPage>
